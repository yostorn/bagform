<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Bag Size Form</title>
    <style>
        label, input, select, button {
            display: block;
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <h1>เลือกประเภทถุง</h1>
    <form id="bagForm">
        <label for="bagType">เลือกประเภทถุง:</label>
        <select id="bagType" name="bagType">
            <option value="type1">ไม่พับปาก ไม่ใส่หู</option>
            <option value="type2">ไม่พับปาก ใส่หูเกลียวกระดาษ</option>
            <option value="type3">พับปากถุง ไม่ใส่หูเกลียว (ใส่หูเชือกได้)</option>
            <option value="type4">พับปากถุง ใส่หูเกลียวกระดาษ</option>
        </select>
        <h2>กรอกมิติของถุง</h2>
        <label for="dValue">D (cm):</label>
        <input type="number" id="dValue" name="dValue" step="0.1">
        <label for="wValue">W (cm):</label>
        <input type="number" id="wValue" name="wValue">
        <label for="hValue">H (cm):</label>
        <input type="number" id="hValue" name="hValue">
        <button type="button" onclick="checkSize()">ตรวจสอบ</button>
    </form>
    <p id="result"></p>
    <p id="paperSize"></p>

    <script>
        const sizeLimits = {
            "type1": { "7": [18, 38, 26.5, 49.5], "7.5": [18, 38, 26.25, 49.25], "8": [18, 38, 26, 49], "8.5": [18, 38, 25.75, 48.75], "9": [18, 38, 25.5, 48.5], "9.5": [18, 38, 25.25, 48.25] },
            "type2": { "7": [18, 38, 26.5, 49.5], "7.5": [18, 38, 26.25, 49.25], "8": [18, 38, 26, 49], "8.5": [18, 38, 25.75, 48.75], "9": [18, 38, 25.5, 48.5], "9.5": [18, 38, 25.25, 48.25] },
            "type3": { "7": [18, 38, 26.5, 44.5], "7.5": [18, 38, 26.25, 44.25], "8": [18, 38, 26, 44], "8.5": [18, 38, 25.75, 43.75], "9": [18, 38, 25.5, 43.5], "9.5": [18, 38, 25.25, 43.25] },
            "type4": { "7": [18, 38, 26.5, 44.5], "7.5": [18, 38, 26.25, 44.25], "8": [18, 38, 26, 44], "8.5": [18, 38, 25.75, 43.75], "9": [18, 38, 25.5, 43.5], "9.5": [18, 38, 25.25, 43.25] }
        };

        function checkSize() {
            const bagType = document.getElementById("bagType").value;
            const dValue = parseFloat(document.getElementById("dValue").value);
            const wValue = parseFloat(document.getElementById("wValue").value);
            const hValue = parseFloat(document.getElementById("hValue").value);

            let resultText = "ไม่สามารถตรวจสอบได้";
            let paperSizeText = "";

            if (dValue in sizeLimits[bagType]) {
                const limits = sizeLimits[bagType][dValue];
                const [wMin, wMax, hMin, hMax] = limits;

                if ((wValue >= wMin && wValue <= wMax) && (hValue >= hMin && hValue <= hMax)) {
                    resultText = "ขนาดถุงที่ต้องการสามารถผลิตได้";

                    // คำนวณขนาดกระดาษ
                    let verticalSize = hValue + ((dValue / 2) + 1.5);
                    let horizontalSize = dValue + wValue + dValue + wValue + 1.5;

                    // ถ้าเป็นแบบพับปากถุง ให้บวกเพิ่มอีก 5 ซม.
                    if (bagType === "type3" || bagType === "type4") {
                        verticalSize += 5;
                    }

                    // แปลงขนาดจากเซนติเมตรเป็นนิ้ว (1 นิ้ว = 2.54 ซม.)
                    verticalSize = (verticalSize / 2.54).toFixed(2);
                    horizontalSize = (horizontalSize / 2.54).toFixed(2);

                    paperSizeText = `ขนาดกระดาษที่ต้องใช้คือ: Vertical = ${verticalSize} นิ้ว, Horizontal = ${horizontalSize} นิ้ว`;
                } else {
                    resultText = "ขนาดถุงที่ต้องการไม่สามารถผลิตได้";
                    if (wValue < wMin || wValue > wMax) {
                        resultText += ` เนื่องจาก W ต้องอยู่ในช่วง ${wMin}-${wMax} ซม.`;
                    }
                    if (hValue < hMin || hValue > hMax) {
                        resultText += ` เนื่องจาก H ต้องอยู่ในช่วง ${hMin}-${hMax} ซม.`;
                    }
                }
            } else {
                resultText = "ค่า D ไม่ถูกต้อง";
            }

            document.getElementById("result").innerText = resultText;
            document.getElementById("paperSize").innerText = paperSizeText;
        }
    </script>
</body>
</html>
